\documentclass[10pt]{article}

% Basic packages
\usepackage[margin=2.5cm]{geometry}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{color}
\usepackage{fancyhdr}
\usepackage{booktabs}
\usepackage{float}
\usepackage{titlesec}
\usepackage{hyperref}
\usepackage{fancyvrb}
\usepackage{framed}
\usepackage{listings}
\usepackage{tcolorbox}
\usepackage{helvet}
\usepackage{enumitem}
\usepackage{parskip}
\usepackage{amsmath}
\usepackage{tocloft}
\usepackage{calc}

% Force all tables to use longtable
\usepackage{longtable}

% Automatic line wrapping in table cells
\usepackage{array}
\usepackage{tabularx}
\usepackage{ltablex} % Combines longtable + tabularx

% Keep longtable functionality with tabularx
\keepXColumns

% Fix longtable spacing and prevent overlapping
\usepackage{setspace}
\setlength{\LTpre}{10pt}
\setlength{\LTpost}{10pt}
\setlength{\LTcapwidth}{\textwidth}

% Better table spacing
\renewcommand{\arraystretch}{1.3}
\setlength{\tabcolsep}{6pt}

% Suppress the default title for the Table of Contents
\renewcommand{\contentsname}{}

% Suppress the default title for the List of Tables
\renewcommand{\listtablename}{}

% Suppress the default title for the List of Figures
\renewcommand{\listfigurename}{}

% Set maxwidth for image
\makeatletter
% Access LaTeX internals
\makeatletter

% REDEFINITION 1: Define \maxwidth to ensure images don't exceed text width
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}

% REDEFINITION 2: Define \maxheight with a more reasonable limit
\def\maxheight{\ifdim\Gin@nat@height>0.8\textheight 0.8\textheight\else\Gin@nat@height\fi}

% Apply the scaling keys to all \includegraphics commands
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}

\makeatother

% Force all figures to appear HERE
\floatplacement{figure}{H}

% Set number for table or figure
\numberwithin{table}{section}
\numberwithin{figure}{section}

% Set default font
\renewcommand{\familydefault}{\sfdefault}

% Pandoc requirements
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

% Handle inline code properly
\usepackage{listingsutf8}
\usepackage{upquote}
\usepackage{textcomp}

% Define inline code command for pandoc
\newcommand{\passthrough}[1]{#1}

% Better handling of verbatim text
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\},fontsize=\small}
\newenvironment{Shaded}{}{}

% Define inline code styling
\newcommand{\styledtexttt}[1]{%
  \colorbox{gray!15}{%
    \textcolor{blue!80!black}{%
      \footnotesize\texttt{#1}%
    }%
  }%
}

% Define colors for syntax highlighting
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{codeblue}{rgb}{0.0,0.0,1.0}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}
\definecolor{keywordcolor}{rgb}{0.0,0.0,0.75}
\definecolor{commentcolor}{rgb}{0.133,0.545,0.133}
\definecolor{stringcolor}{rgb}{0.627,0.126,0.941}

% Define pandoc syntax highlighting tokens
\newcommand{\FunctionTok}[1]{\textcolor{keywordcolor}{\textbf{#1}}}
\newcommand{\KeywordTok}[1]{\textcolor{keywordcolor}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor{codepurple}{\textbf{#1}}}
\newcommand{\DecValTok}[1]{\textcolor{codeblue}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor{codeblue}{#1}}
\newcommand{\FloatTok}[1]{\textcolor{codeblue}{#1}}
\newcommand{\CharTok}[1]{\textcolor{stringcolor}{#1}}
\newcommand{\StringTok}[1]{\textcolor{stringcolor}{#1}}
\newcommand{\CommentTok}[1]{\textcolor{commentcolor}{\textit{#1}}}
\newcommand{\OtherTok}[1]{\textcolor{black}{#1}}
\newcommand{\AlertTok}[1]{\textcolor{red}{\textbf{#1}}}
\newcommand{\AnnotationTok}[1]{\textcolor{red}{\textbf{#1}}}
\newcommand{\AttributeTok}[1]{\textcolor{codegreen}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor{keywordcolor}{\textbf{#1}}}
\newcommand{\ControlFlowTok}[1]{\textcolor{keywordcolor}{\textbf{#1}}}
\newcommand{\DocumentationTok}[1]{\textcolor{commentcolor}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor{red}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{\textcolor{codegreen}{#1}}
\newcommand{\ImportTok}[1]{\textcolor{keywordcolor}{\textbf{#1}}}
\newcommand{\InformationTok}[1]{\textcolor{blue}{#1}}
\newcommand{\NormalTok}[1]{\textcolor{black}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor{black}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor{red}{\textbf{#1}}}
\newcommand{\RegionMarkerTok}[1]{\textcolor{black}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor{red}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor{stringcolor}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor{stringcolor}{#1}}
\newcommand{\VariableTok}[1]{\textcolor{codegreen}{#1}}
\newcommand{\WarningTok}[1]{\textcolor{orange}{\textbf{#1}}}

% Configure listings globally
\lstset{
    backgroundcolor=\color{backcolour},
    commentstyle=\color{commentcolor}\itshape,
    keywordstyle=\color{keywordcolor}\bfseries,
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{stringcolor},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    keepspaces=true,
    numbers=left,
    numbersep=5pt,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=2,
    frame=single,
    frameround=tttt,
    framesep=3pt,
    rulecolor=\color{black!30},
    aboveskip=10pt,
    belowskip=10pt
}

% Define specific languages
\lstdefinelanguage{bash}{
    basicstyle=\ttfamily\footnotesize\color{black},
    keywords={if,then,else,elif,fi,for,in,while,until,do,done,case,esac,function,select,time,coproc,let,declare,typeset,alias,unalias,set,unset,readonly,export,exec,eval,source,exit,return,break,continue,shift,getopts,read,echo,printf,test,true,false},
    keywordstyle=\color{keywordcolor}\bfseries,
    ndkeywords={sudo,apt,yum,wget,curl,grep,sed,awk,sort,uniq,head,tail,cat,less,more,find,locate,which,whereis,chmod,chown,chgrp,ls,cd,pwd,mkdir,rmdir,rm,cp,mv,ln,tar,gzip,gunzip,zip,unzip},
    ndkeywordstyle=\color{codepurple}\bfseries,
    sensitive=true,
    comment=[l]{\#},
    commentstyle=\color{commentcolor}\itshape,
    string=[b]",
    string=[b]',
    stringstyle=\color{stringcolor},
    showstringspaces=false
}

\lstdefinelanguage{ruby}{
    keywords={alias, and, begin, break, case, class, def, defined, do, else, elsif, end, ensure, false, for, if, in, module, next, nil, not, or, redo, rescue, retry, return, self, super, then, true, undef, unless, until, when, while, yield},
    keywordstyle=\color{keywordcolor}\bfseries,
    ndkeywords={require, include, extend, attr_accessor, attr_reader, attr_writer, private, protected, public, class, module, def, end, if, unless, while, until, for, each, map, select, reject, find, detect, inject, reduce},
    ndkeywordstyle=\color{codepurple}\bfseries,
    identifierstyle=\color{black},
    sensitive=true,
    comment=[l]{\#},
    morecomment=[s]{=begin}{=end},
    commentstyle=\color{commentcolor}\itshape,
    stringstyle=\color{stringcolor},
    morestring=[b]',
    morestring=[b]"
}

\lstdefinelanguage{go}{
    keywords={break, default, func, interface, select, case, defer, go, map, struct, chan, else, goto, package, switch, const, fallthrough, if, range, type, continue, for, import, return, var},
    keywordstyle=\color{keywordcolor}\bfseries,
    ndkeywords={string, int, float64, bool, true, false, nil, make, len, cap, append, copy, delete, close, panic, recover},
    ndkeywordstyle=\color{codepurple}\bfseries,
    identifierstyle=\color{black},
    sensitive=true,
    comment=[l]{//},
    morecomment=[s]{/*}{*/},
    commentstyle=\color{commentcolor}\itshape,
    stringstyle=\color{stringcolor},
    morestring=[b]',
    morestring=[b]"
}

\lstdefinelanguage{javascript}{
    keywords={typeof, new, true, false, catch, function, return, null, catch, switch, var, let, const, if, in, while, do, else, case, break, async, await, class, extends, import, export, from, default},
    keywordstyle=\color{keywordcolor}\bfseries,
    ndkeywords={class, export, boolean, throw, implements, import, this, super, constructor, static, get, set},
    ndkeywordstyle=\color{codepurple}\bfseries,
    identifierstyle=\color{black},
    sensitive=false,
    comment=[l]{//},
    morecomment=[s]{/*}{*/},
    commentstyle=\color{commentcolor}\itshape,
    stringstyle=\color{stringcolor},
    morestring=[b]',
    morestring=[b]"
}

\lstdefinelanguage{jsx}{
    keywords={typeof, new, true, false, catch, function, return, null, catch, switch, var, let, const, if, in, while, do, else, case, break, async, await, class, extends, import, export, from, default},
    keywordstyle=\color{keywordcolor}\bfseries,
    ndkeywords={class, export, boolean, throw, implements, import, this, super, constructor, static, get, set, React, Component, useState, useEffect, props, state},
    ndkeywordstyle=\color{codepurple}\bfseries,
    identifierstyle=\color{black},
    sensitive=false,
    comment=[l]{//},
    morecomment=[s]{/*}{*/},
    commentstyle=\color{commentcolor}\itshape,
    stringstyle=\color{stringcolor},
    morestring=[b]',
    morestring=[b]",
    tagstyle=\color{codegreen}\bfseries,
    tag=[s]{<}{>},
    tagprefix=\color{codegreen},
    tagprefixstyle=\color{codegreen}
}

% Section formatting to match ODT template with better spacing
\titleformat{\section}
  {\fontsize{12}{20}\selectfont\bfseries\color{orange}}
  {\thesection}{1em}{}
\titlespacing*{\section}{0pt}{16pt plus 6pt minus 3pt}{12pt plus 4pt minus 3pt}

\titleformat{\subsection}
  {\fontsize{11}{18}\selectfont\bfseries}{\thesubsection}{1em}{}
\titlespacing*{\subsection}{0pt}{14pt plus 6pt minus 3pt}{10pt plus 4pt minus 3pt}

\titleformat{\subsubsection}
  {\fontsize{10.5}{16}\selectfont\bfseries}{\thesubsubsection}{1em}{}
\titlespacing*{\subsubsection}{0pt}{12pt plus 6pt minus 3pt}{8pt plus 4pt minus 3pt}

\titleformat{\paragraph}
  {\fontsize{10}{14}\selectfont\itshape\bfseries}{\theparagraph}{1em}{}
\titlespacing*{\paragraph}{0pt}{10pt plus 6pt minus 3pt}{6pt plus 4pt minus 3pt}

% Header/footer setup
\pagestyle{fancy}
\fancyhead{}
\fancyhead[RO,LE]{%
  \includegraphics[height=1cm]{./logo.jpeg}%
}
\fancyfoot{}
\fancyfoot[LE,RO]{\thepage}
\fancyfoot[LO,CE]{Copyright Â© \the\year, Bestarion.}
\renewcommand{\footrulewidth}{0.4pt}

% Custom table styling
\renewcommand{\arraystretch}{1.2}

% Better page break handling for long tables
\setlength{\LTleft}{0pt}
\setlength{\LTright}{0pt}

% Prevent table overlappinlg with text
\renewcommand{\LTcapwidth}{\textwidth}
\renewcommand{\LTleft}{0pt}
\renewcommand{\LTright}{0pt}

\begin{document}

% COVER PAGE
% Clear header and footer for cover page
\thispagestyle{empty} % Ensure NO page number appears on the cover page

\begin{center}
	\vspace*{2cm}
	\includegraphics[width=0.25\textwidth]{./logo.jpeg}\\[2cm]
	\setlength{\baselineskip}{40pt}
	{\fontsize{36}{50}\selectfont \textcolor{orange}{\textbf{\MakeUppercase{$title$}}}}\\[0.5cm]
	{\fontsize{18}{22}\selectfont \textbf{SDD}}\\[3cm]
\end{center}
\vspace*{1cm}

% Full width table for cover page
\begin{table}[H]
	\centering
	\begin{tabular}{ | p{0.1\textwidth} | p{0.4\textwidth}| p{0.4\textwidth} | }
		\hline
		 & \textbf{Security classification:} & $security_classification$ \\
		\hline
		 & \textbf{Document code:}           & $document_code$           \\
		\hline
		 & \textbf{Last updated by:}         & $author$                  \\
		\hline
		 & \textbf{Effective date:}          & $effective_date$          \\
		\hline
		 & \textbf{Version:}                 & $version$                 \\
		\hline
		 & \textbf{Template ID:}             & $template_id$             \\
		\hline
	\end{tabular}
\end{table}
\clearpage

\pagenumbering{arabic} 
\setcounter{page}{1} % set page number start from 1

% DOCUMENT CONTROL
\section*{\fontsize{15}{18}\selectfont \textcolor{orange}{\textbf{DOCUMENT CONTROL}}}
$if(changelog)$
\begin{longtable}{|p{0.08\textwidth}|p{0.22\textwidth}|p{0.14\textwidth}|p{0.12\textwidth}|p{0.16\textwidth}|p{0.12\textwidth}|}
	\hline
	\textbf{Version}         & \textbf{Change Description} & \textbf{Changed By} & \textbf{Date} & \textbf{Approved By} & \textbf{Date} \\
	\hline
	$for(changelog)$
	$changelog.version$      &
	$changelog.description$  &
	$changelog.changed_by$   &
	$changelog.changed_date$ &
	$changelog.approved$     &
	$changelog.approval_date$                                                                                                           \\
	\hline
	$endfor$
\end{longtable}
$endif$
\clearpage

% TABLE OF CONTENTS
\section*{\fontsize{15}{18}\selectfont \textbf{TABLE OF CONTENTS}}
\tableofcontents
\clearpage

% List of fitures
\section*{\fontsize{15}{18}\selectfont \textbf{INDEX OF TABLES}}
\listoftables
\clearpage

\section*{\fontsize{15}{18}\selectfont \textbf{INDEX OF FIGURES}}
\listoffigures
\clearpage

% MAIN CONTENT
$body$

\end{document}
